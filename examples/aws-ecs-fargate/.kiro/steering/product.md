# Product Overview

## What is terraform-basemachina-modules?

terraform-basemachina-modulesは、BaseMachina BridgeをAWS上に本番環境レベルでデプロイするためのTerraformモジュール集です。セキュアで、コスト最適化され、運用しやすいインフラストラクチャを提供します。

## Core Features

### インフラストラクチャモジュール
- **AWS ECS Fargate デプロイメント**: サーバーレスコンテナ実行基盤
- **Application Load Balancer (ALB)**: HTTPS終端と高可用性を提供
- **VPCエンドポイント統合**: NAT Gateway不要でAWSサービスにアクセス
- **ECRプルスルーキャッシュ**: Public ECRイメージを自動キャッシュ
- **NAT Gateway サポート**: Bridge初期化用のインターネットアクセス
- **RDS PostgreSQL統合**: データベース接続とシードデータ投入
- **Secrets Manager統合**: 認証情報の安全な管理

### セキュリティ機能
- **プライベートサブネット配置**: ECSタスクはインターネットから隔離
- **セキュリティグループ管理**: 最小権限の原則に基づくネットワーク制御
- **TLS/SSL暗号化**: ACM証明書によるHTTPS通信
- **IPホワイトリスト**: BaseMachinaからのアクセスのみ許可
- **暗号化ストレージ**: RDSデータの保護

### 運用機能
- **CloudWatch Logs統合**: 集中ログ管理
- **Enhanced Monitoring**: RDSパフォーマンス監視
- **Performance Insights**: データベースクエリ分析
- **自動バックアップ**: 7日間のRDSバックアップ保持
- **Auto Scaling対応**: タスク数の調整が容易

### テスト機能
- **統合テスト**: Terratest による自動テスト
- **ネットワーク診断**: 詳細なトラブルシューティング機能
- **自己署名証明書サポート**: テスト環境向けHTTPS検証

## Target Use Case

### プライマリユースケース
**BaseMachina Bridgeの本番環境デプロイ**
- エンタープライズ向けセキュアなデプロイメント
- プライベートVPC内での実行
- 既存のRDS/Auroraデータベースへの接続
- 高可用性と自動復旧

### セカンダリユースケース
**開発・テスト環境**
- 自己署名証明書によるHTTPS検証
- RDSインスタンス付き完全な環境
- シードデータによる動作確認
- コスト最適化された小規模構成

### アーキテクチャパターン
**VPCエンドポイント + ECRプルスルーキャッシュ（推奨）**
- コスト: 約$21/月（NAT Gateway不要）
- セキュリティ: 完全プライベートネットワーク
- パフォーマンス: AWSバックボーン経由の高速アクセス

**NAT Gateway（従来型）**
- コスト: 約$32/月 + データ転送料
- 柔軟性: 任意の外部サービスへのアクセス可能

## Key Value Proposition

### 1. プロダクションレディ
- AWS Well-Architectedフレームワークに準拠
- セキュリティベストプラクティスを実装
- 自動化されたテストによる品質保証

### 2. コスト最適化
- VPCエンドポイントによるNAT Gateway不要化
- ECRプルスルーキャッシュによるデータ転送料削減
- 適切なインスタンスサイズとストレージ設定

### 3. セキュリティファースト
- プライベートサブネット配置
- 最小権限の原則
- 暗号化（転送時・保管時）
- Secrets Managerによる認証情報管理

### 4. 運用性
- 詳細なログとモニタリング
- 自動バックアップとリカバリ
- Infrastructure as Code（IaC）による再現性
- 包括的なドキュメント

### 5. 柔軟性
- カスタマイズ可能な設定
- 既存インフラとの統合
- マルチAZ対応（オプション）
- 複数環境のサポート

## Differentiators

### vs 手動構築
- **一貫性**: Terraformによる宣言的な構成管理
- **再現性**: 同じ構成を複数環境で展開可能
- **バージョン管理**: インフラの変更履歴を追跡

### vs 他のTerraformモジュール
- **BaseMachina特化**: Bridge要件に最適化された設計
- **包括的なテスト**: 実際のAWS環境でのテスト済み
- **詳細なドキュメント**: 日本語での説明とトラブルシューティング

### vs コンテナオーケストレーションサービス（EKS等）
- **シンプル**: Fargate による完全マネージド
- **コスト効率**: 小規模デプロイに最適
- **運用負荷削減**: ノード管理不要
