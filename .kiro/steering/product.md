# プロダクト概要

## プロダクトの説明

BaseMachina Bridge Terraform Modulesは、BaseMachinaのbridgeをお客様のクラウド環境に簡単にデプロイするためのTerraformモジュール集です。bridgeは、BaseMachinaからお客様が持つデータベースやAPIへアクセスする際に中継する、認証機能付きのゲートウェイ（プロキシ）です。

## 主要機能

- **マルチクラウド対応**: AWS（ECS Fargate）とGoogle Cloud（Cloud Run）をサポート（両方実装済み）
- **簡単なデプロイ**: Terraformモジュールを使って、bridgeのインフラストラクチャを自動的にプロビジョニング
- **セキュアなアクセス**: 認証機能付きゲートウェイとして、BaseMachinaからお客様のデータソースへの安全なアクセスを提供
- **ヘルスチェック機能**: `/ok`エンドポイントによる監視とヘルスチェック
- **柔軟な設定**: 環境変数によるカスタマイズ（認証更新間隔、タイムアウト、ポート、テナントID）
- **証明書管理**: 複数の証明書オプション
  - DNS検証によるACM証明書の自動発行（Route53統合、推奨）
  - 自己署名証明書の生成とACMインポート
  - 既存のACM証明書の利用
  - HTTPのみの構成（テスト環境向け）
- **DNS統合**: Route53による自動的なDNSレコード作成とドメイン管理
- **包括的なテスト**: Terratestによる自動化された統合テスト（HTTPS疎通確認、ヘルスチェック）

## ターゲットユースケース

### 主要なユースケース

1. **プライベートデータソースへの安全なアクセス**
   - お客様のVPC内のプライベートRDSやCloud SQLへのアクセス
   - 社内APIエンドポイントへのセキュアな接続

2. **コンプライアンス要件への対応**
   - データを外部に出さずに、BaseMachinaのサービスを利用したい企業
   - IPホワイトリストやネットワークセグメンテーションが必要な環境

3. **エンタープライズ導入**
   - Infrastructure as Code（IaC）によるガバナンスとバージョン管理
   - 複数環境（開発、ステージング、本番）への標準化されたデプロイ

### 想定される利用シーン

- BaseMachinaを使ったデータ分析で、オンプレミスやプライベートクラウドのデータソースにアクセスする
- セキュリティポリシーにより、外部サービスからの直接アクセスが制限されている環境
- Terraformを使ったインフラ管理を既に行っており、bridgeもコード化したい

## 主要な価値提案

### ユニークな利点

1. **セキュアなアーキテクチャ**
   - BaseMachinaからのアクセスは認証されたbridgeを経由するため、データソースを直接公開する必要がない
   - IPホワイトリスト（34.85.43.93）による追加のセキュリティレイヤー

2. **運用負荷の軽減**
   - DockerコンテナとしてパッケージされたBridgeイメージ（AWS ECR/GCR）を使用
   - マネージドサービス（ECS Fargate、Cloud Run）で実行するため、インフラ管理が最小限

3. **Infrastructure as Code**
   - Terraformによる再現可能で監査可能なインフラストラクチャ
   - GitOpsワークフローとの統合が容易

4. **マルチクラウド対応**
   - AWS、GCPの主要クラウドプロバイダーをサポート
   - 各クラウドのベストプラクティスに基づいた実装

5. **柔軟な設定**
   - 環境変数による認証更新間隔やタイムアウトのカスタマイズ
   - テナントIDによるマルチテナント対応

6. **自動化されたDNS管理**
   - Route53統合によるDNS検証とレコード作成の自動化
   - カスタムドメインでのBridge展開が容易
   - ACM証明書のDNS検証により、手動での証明書管理が不要
